{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Formulario de Trabajo</title>
  <link rel="stylesheet" href="{% static 'css/registro_individual.css' %}" />
</head>

<body class="fondo">
  <div class="formulario">
    <div class="volver">
      <button type="button" onclick="location.href='{% url 'trabajos:index_trabajo' %}'">← Volver</button>
    </div>

    <h2>Información del Trabajo</h2>
    <p>Detalles sobre tu oferta de trabajo</p>

    <form enctype="multipart/form-data" method="POST">
      {% csrf_token %}

      {% if form.errors %}
        <div style="color: red;">
          <ul>
            {% for field in form %}
              {% for error in field.errors %}
                <li>{{ field.label }}: {{ error }}</li>
              {% endfor %}
            {% endfor %}
            {% for error in form.non_field_errors %}
              <li>{{ error }}</li>
            {% endfor %}
          </ul>
        </div>
      {% endif %}

      <!-- Título y Pago -->
      <div>
        <label>{{ form.titulo.label }}</label>
        {{ form.titulo }}
      </div>

      <div>
        <label>{{ form.pago.label }}</label>
        {{ form.pago }}
      </div>

      <!-- Fecha límite -->
      <div class="campo">
        <label>{{ form.fecha_limite.label }}</label>
        {{ form.fecha_limite }}
      </div>

      <!-- Hora límite -->
      <div class="campo">
        <label>{{ form.horas_limite.label }}</label>
        {{ form.horas_limite }}
      </div>

      <!-- Descripción -->
      <div class="campo">
        <label>{{ form.descripcion.label }}</label>
        {{ form.descripcion }}
      </div>

      <!-- Herramientas -->
      <div class="campo">
        <label>{{ form.herramientas.label }}</label>
        {{ form.herramientas }}
      </div>

      <!-- Dirección -->
      <div class="direccion">
        <label>{{ form.id_departamento.label }}</label>
        {{ form.id_departamento }}

        <label>{{ form.id_provincia.label }}</label>
        {{ form.id_provincia }}

        <label>{{ form.id_distrito.label }}</label>
        {{ form.id_distrito }}

        <label>{{ form.id_comunidad.label }}</label>
        {{ form.id_comunidad }}

        <label>{{ form.direccion_detalle.label }}</label>
        {{ form.direccion_detalle }}
      </div>

      <!-- Foto -->
      <div class="campo foto-opcional">
        <label>{{ form.foto.label }}</label>
        {{ form.foto }}
        <img id="preview-imagen" src="" alt="Vista previa" style="margin-top: 10px; max-width: 100%; display: none; border: 1px solid #ccc; border-radius: 8px;" />
      </div>

      <!-- Estado oculto (si quieres mantenerlo activo por defecto) -->
      {{ form.estado.as_hidden }}

      <!-- Botón -->
      <div class="boton">
        <button type="submit">Completar Registro</button>
      </div>
    </form>
  </div>

  <script>
    document.querySelector('input[type="file"]').addEventListener("change", function (event) {
      const imagenPreview = document.getElementById("preview-imagen");
      const archivo = event.target.files[0];
      if (archivo) {
        const lector = new FileReader();
        lector.onload = function (e) {
          imagenPreview.src = e.target.result;
          imagenPreview.style.display = "block";
        };
        lector.readAsDataURL(archivo);
      } else {
        imagenPreview.src = "";
        imagenPreview.style.display = "none";
      }
    });
  </script>
</body>
</html>
